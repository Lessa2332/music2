<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–¢–≤–æ—Ä–µ—Ü—å –°–≤—ñ—Ç—ñ–≤ ‚Äî –ì–µ–æ–ª–æ–≥—ñ—á–Ω–∏–π —Å–∏–º—É–ª—è—Ç–æ—Ä</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #0e1b24;
  color: #fff;
  text-align: center;
  touch-action: manipulation;
}

h1 { margin: 12px; }

#container {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 20px;
  padding: 10px;
}

canvas {
  border: 3px solid #fff;
  border-radius: 8px;
  box-shadow: 0 0 20px rgba(0,0,0,0.8);
  touch-action: none;
}

.controls {
  min-width: 320px;
  max-width: 360px;
  padding: 15px;
  background: rgba(255,255,255,0.05);
  border-radius: 10px;
  text-align: left;
}

.controls h3 {
  margin: 15px 0 8px;
  color: #ffd966;
  font-size: 18px;
}

button {
  width: 100%;
  margin: 5px 0;
  padding: 10px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-size: 15px;
  transition: transform 0.1s;
}

button:active { transform: scale(0.98); }

.internal { background: #c0392b; color: #fff; }
.external { background: #2980b9; color: #fff; }
.disaster { background: #8e44ad; color: #fff; }
.utility  { background: #27ae60; color: #fff; }

#view-mode {
  display: flex;
  gap: 10px;
  margin: 10px 0;
}

#view-mode button {
  flex: 1;
  background: #34495e;
  padding: 10px;
  font-size: 15px;
}

#view-mode button.active {
  background: #ffd966;
  color: #000;
  font-weight: bold;
}

#brush-size {
  display: flex;
  gap: 10px;
  margin: 10px 0;
}

#brush-size button {
  flex: 1;
  background: #34495e;
  padding: 8px;
  font-size: 14px;
}

#brush-size button.active {
  background: #ffd966;
  color: #000;
}

#info {
  font-size: 13px;
  margin-top: 12px;
  opacity: 0.9;
  line-height: 1.4;
}
</style>
</head>

<body>

<h1>üåç –¢–≤–æ—Ä–µ—Ü—å –°–≤—ñ—Ç—ñ–≤</h1>
<p>–Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞ –≥–µ–æ–ª–æ–≥—ñ—á–Ω–∞ —Å–∏–º—É–ª—è—Ü—ñ—è (–ù–£–®)</p>

<div id="container">
  <canvas id="world" width="600" height="600"></canvas>

  <div class="controls">
    <h3>üëÅÔ∏è –†–µ–∂–∏–º –ø–µ—Ä–µ–≥–ª—è–¥—É</h3>
    <div id="view-mode">
      <button class="active" onclick="setViewMode('top')">–ö–∞—Ä—Ç–∞ –∑–≤–µ—Ä—Ö—É</button>
      <button onclick="setViewMode('cross')">–ì–µ–æ–ª–æ–≥—ñ—á–Ω–∏–π —Ä–æ–∑—Ä—ñ–∑</button>
    </div>

    <h3>üñåÔ∏è –ú–∞–ª—é–≤–∞–Ω–Ω—è (—Ç—ñ–ª—å–∫–∏ –≤ —Ä–µ–∂–∏–º—ñ –∫–∞—Ä—Ç–∏)</h3>
    <div id="brush-size">
      <button class="active" onclick="setBrush(1)">–ú–∞–ª–∞</button>
      <button onclick="setBrush(3)">–°–µ—Ä–µ–¥–Ω—è</button>
      <button onclick="setBrush(5)">–í–µ–ª–∏–∫–∞</button>
    </div>
    <p style="font-size:13px;margin:8px 0;">‚úã –ú–∞–ª—é–π –º–∏—à–µ—é/–ø–∞–ª—å—Ü–µ–º<br>‚ÜïÔ∏è Shift ‚Äî –æ–ø—É—Å–∫–∞—Ç–∏</p>

    <h3>üî¥ –í–Ω—É—Ç—Ä—ñ—à–Ω—ñ –ø—Ä–æ—Ü–µ—Å–∏</h3>
    <button class="internal" onclick="uplift()">‚¨ÜÔ∏è –¢–µ–∫—Ç–æ–Ω—ñ—á–Ω–µ –ø—ñ–¥–Ω—è—Ç—Ç—è</button>
    <button class="internal" onclick="fault()">‚ö° –†–æ–∑–ª–æ–º (–∑–∏–≥–∑–∞–≥)</button>
    <button class="internal" onclick="volcano()">üåã –í—É–ª–∫–∞–Ω</button>

    <h3>üîµ –ó–æ–≤–Ω—ñ—à–Ω—ñ –ø—Ä–æ—Ü–µ—Å–∏</h3>
    <button class="external" onclick="rain()">üåß –†—ñ—á–∫–æ–≤–∞ –µ—Ä–æ–∑—ñ—è</button>
    <button class="external" onclick="wind()">üå¨ –í—ñ—Ç—Ä–æ–≤–∞ –µ—Ä–æ–∑—ñ—è</button>
    <button class="external" onclick="glacier()">üßä –ó–ª–µ–¥–µ–Ω—ñ–Ω–Ω—è</button>
    <button class="external" onclick="weathering()">ü™® –í–∏–≤—ñ—Ç—Ä—é–≤–∞–Ω–Ω—è</button>

    <h3>üö® –ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏</h3>
    <button class="disaster" onclick="flood()">üåä –ü–æ–≤—ñ–Ω—å</button>
    <button class="disaster" onclick="earthquake()">üåê –ó–µ–º–ª–µ—Ç—Ä—É—Å</button>
    <button class="disaster" onclick="landslide()">‚¨áÔ∏è –ó—Å—É–≤</button>
    <button class="disaster" onclick="eruption()">üî• –í–∏–≤–µ—Ä–∂–µ–Ω–Ω—è</button>

    <h3>‚öôÔ∏è –ö–µ—Ä—É–≤–∞–Ω–Ω—è</h3>
    <button class="utility" onclick="resetWorld()">üîÑ –û—á–∏—Å—Ç–∏—Ç–∏</button>
    <button class="utility" onclick="randomWorld()">üé≤ –í–∏–ø–∞–¥–∫–æ–≤–∏–π —Å–≤—ñ—Ç</button>

    <div id="info">
      üî¥ –£ —Ä–µ–∂–∏–º—ñ —Ä–æ–∑—Ä—ñ–∑—É –≤–∏–¥–Ω–æ –∫–æ—Ä—É —Ç–∞ –º–∞–Ω—Ç—ñ—é!<br>
      üåã –ì–ª–∏–±–æ–∫—ñ —Ä–æ–∑–ª–æ–º–∏ –æ–≥–æ–ª—é—é—Ç—å –º–∞–≥–º—É<br>
      üí° –°–ø—Ä–æ–±—É–π —Ä–æ–∑–ª–æ–º ‚Üí –≤—É–ª–∫–∞–Ω ‚Üí –µ—Ä–æ–∑—ñ—é
    </div>
  </div>
</div>

<script>
const canvas = document.getElementById("world");
const ctx = canvas.getContext("2d");

const size = 120;
const cell = canvas.width / size;
let heightMap = [];
let brushSize = 1;
let lowering = false;
let viewMode = 'top'; // 'top' –∞–±–æ 'cross'

function init() {
  heightMap = Array.from({length: size}, () => Array(size).fill(0));
  draw();
}

function getSurfaceColor(h) {
  if (h <= -8) return "#001133";
  if (h <= -2) return "#003366";
  if (h <= 0)  return "#006699";
  if (h <= 3)  return "#66b2ff";
  if (h <= 10) return "#b3ff99";
  if (h <= 20) return "#99cc66";
  if (h <= 35) return "#b3863d";
  if (h <= 50) return "#888888";
  return "#ffffff";
}

function drawTopView() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  for (let y = 0; y < size; y++) {
    for (let x = 0; x < size; x++) {
      const h = heightMap[y][x];
      ctx.fillStyle = getSurfaceColor(h);
      ctx.fillRect(x * cell, y * cell, cell, cell);
    }
  }

  // –í–æ–¥–∞
  ctx.fillStyle = "rgba(0, 100, 200, 0.4)";
  for (let y = 0; y < size; y++) {
    for (let x = 0; x < size; x++) {
      if (heightMap[y][x] <= 0) {
        ctx.fillRect(x * cell, y * cell, cell, cell);
      }
    }
  }

  drawDynamicLabels();
}

function drawCrossSection() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const centerY = Math.floor(size / 2);
  const profile = heightMap[centerY];

  const verticalScale = 6; // –∑–±—ñ–ª—å—à–µ–Ω–µ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–µ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è
  const crustThickness = 15;
  const baseY = canvas.height * 0.8; // —Ä—ñ–≤–µ–Ω—å –º–∞–Ω—Ç—ñ—ó

  // –§–æ–Ω –º–∞–Ω—Ç—ñ—ó
  const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
  gradient.addColorStop(0, "#ff5500");
  gradient.addColorStop(0.6, "#ff2200");
  gradient.addColorStop(1, "#880000");
  ctx.fillStyle = gradient;
  ctx.fillRect(0, baseY - crustThickness * verticalScale, canvas.width, canvas.height);

  // –ö–æ—Ä–∞ (–ª—ñ—Ç–æ—Å—Ñ–µ—Ä–∞)
  ctx.fillStyle = "#8b7355";
  ctx.fillRect(0, baseY - crustThickness * verticalScale, canvas.width, crustThickness * verticalScale);

  // –ü–æ–≤–µ—Ä—Ö–Ω—è + —Ä–µ–ª—å—î—Ñ
  ctx.beginPath();
  ctx.moveTo(0, baseY);
  for (let x = 0; x < size; x++) {
    const h = profile[x];
    const y = baseY - h * verticalScale;
    ctx.lineTo(x * cell, y);

    // –ú–∞–≥–º–∞ –ø—Ä–∏ –≥–ª–∏–±–æ–∫–∏—Ö —Ä–æ–∑–ª–æ–º–∞—Ö
    if (h < -15) {
      ctx.fillStyle = "#ff3300";
      ctx.fillRect(x * cell - cell/2, y, cell, baseY - y + 50);
    }
  }
  ctx.lineTo(canvas.width, baseY);
  ctx.lineTo(0, baseY);
  ctx.closePath();

  // –ó–∞–ª–∏–≤–∫–∞ —Ä–µ–ª—å—î—Ñ—É
  const reliefGrad = ctx.createLinearGradient(0, 0, 0, baseY);
  reliefGrad.addColorStop(0, "#ffffff");
  reliefGrad.addColorStop(0.3, "#888888");
  reliefGrad.addColorStop(0.5, "#b3863d");
  reliefGrad.addColorStop(0.7, "#99cc66");
  reliefGrad.addColorStop(1, "#006699");
  ctx.fillStyle = reliefGrad;
  ctx.fill();

  // –í–æ–¥–∞ –≤ —Ä–æ–∑—Ä—ñ–∑—ñ
  ctx.fillStyle = "rgba(0, 120, 255, 0.5)";
  ctx.fillRect(0, baseY - 5 * verticalScale, canvas.width, 5 * verticalScale);

  // –õ—ñ–Ω—ñ—è —Ä–æ–∑—Ä—ñ–∑—É (–ø–æ–∑–Ω–∞—á–∫–∞)
  ctx.strokeStyle = "#ffd966";
  ctx.lineWidth = 3;
  ctx.setLineDash([10, 5]);
  ctx.beginPath();
  ctx.moveTo(0, baseY);
  ctx.lineTo(canvas.width, baseY);
  ctx.stroke();
  ctx.setLineDash([]);

  // –ü—ñ–¥–ø–∏—Å
  ctx.fillStyle = "white";
  ctx.font = "bold 20px Arial";
  ctx.textAlign = "center";
  ctx.fillText("–ì–µ–æ–ª–æ–≥—ñ—á–Ω–∏–π —Ä–æ–∑—Ä—ñ–∑ –ø–æ —Ü–µ–Ω—Ç—Ä—É", canvas.width/2, 40);
  ctx.font = "16px Arial";
  ctx.fillText("‚Üê –ú–∞–Ω—Ç—ñ—è | –ö–æ—Ä–∞ | –ü–æ–≤–µ—Ä—Ö–Ω—è ‚Üí", canvas.width/2, canvas.height - 20);
}

function draw() {
  if (viewMode === 'top') {
    drawTopView();
  } else {
    drawCrossSection();
  }
}

function drawDynamicLabels() {
  ctx.fillStyle = "rgba(0,0,0,0.6)";
  ctx.fillRect(4, 4, 160, 92);
  ctx.strokeStyle = "#fff";
  ctx.lineWidth = 2;
  ctx.strokeRect(4, 4, 160, 92);

  ctx.fillStyle = "white";
  ctx.font = "bold 14px Arial";
  ctx.textAlign = "left";

  let hasMountains = false, hasPlains = false, hasOcean = false;
  for (let row of heightMap) {
    for (let h of row) {
      if (h > 35) hasMountains = true;
      if (h > 0 && h <= 20) hasPlains = true;
      if (h <= 0) hasOcean = true;
    }
  }

  let offset = 20;
  if (hasMountains) { ctx.fillText("‚õ∞ –ì–æ—Ä–∏", 12, offset); offset += 22; }
  if (hasPlains)    { ctx.fillText("‚ñ≠ –†—ñ–≤–Ω–∏–Ω–∏", 12, offset); offset += 22; }
  if (hasOcean)     { ctx.fillText("üåä –û–∫–µ–∞–Ω", 12, offset); }
}

// –ú–∞–ª—é–≤–∞–Ω–Ω—è (—Ç—ñ–ª—å–∫–∏ –≤ —Ä–µ–∂–∏–º—ñ –∫–∞—Ä—Ç–∏)
canvas.addEventListener("pointerdown", e => { if (viewMode === 'top') sculpt(e); });
canvas.addEventListener("pointermove", e => { if (viewMode === 'top' && (e.buttons === 1 || e.pointerType === "touch")) sculpt(e); });

document.addEventListener("keydown", e => { if (e.key === "Shift") lowering = true; });
document.addEventListener("keyup", e => { if (e.key === "Shift") lowering = false; });

function sculpt(e) {
  const rect = canvas.getBoundingClientRect();
  const x = Math.floor((e.clientX - rect.left) / cell);
  const y = Math.floor((e.clientY - rect.top) / cell);
  if (x < 0 || y < 0 || x >= size || y >= size) return;

  const strength = lowering ? -1.8 : 1.8;
  const r = Math.floor(brushSize / 2);

  for (let dy = -r; dy <= r; dy++) {
    for (let dx = -r; dx <= r; dx++) {
      const nx = x + dx, ny = y + dy;
      if (nx >= 0 && ny >= 0 && nx < size && ny < size) {
        const dist = Math.sqrt(dx*dx + dy*dy);
        if (dist <= r) {
          heightMap[ny][nx] += strength * (1 - dist / (r + 1));
        }
      }
    }
  }
  draw();
}

function setBrush(s) {
  brushSize = s;
  document.querySelectorAll("#brush-size button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
}

function setViewMode(mode) {
  viewMode = mode;
  document.querySelectorAll("#view-mode button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
  draw();
}

// –ü—Ä–æ—Ü–µ—Å–∏
function uplift() {
  for (let i = 0; i < 500; i++) heightMap[rand()][rand()] += 3;
  draw();
}

function fault() {
  let x = rand();
  let deviation = 0;
  for (let y = 0; y < size; y++) {
    deviation += (Math.random() - 0.5) * 6;
    deviation = Math.max(-15, Math.min(15, deviation));
    const fx = Math.floor(x + deviation);
    for (let dx = -4; dx <= 4; dx++) {
      const nx = fx + dx;
      if (nx >= 0 && nx < size) {
        heightMap[y][nx] -= 8 + Math.abs(dx);
      }
    }
  }
  draw();
}

function volcano() {
  const cx = Math.floor(size / 2), cy = Math.floor(size / 2);
  for (let dy = -12; dy <= 12; dy++) {
    for (let dx = -12; dx <= 12; dx++) {
      const d = Math.sqrt(dx*dx + dy*dy);
      if (d < 12) {
        const nx = cx + dx, ny = cy + dy;
        if (nx >= 0 && ny >= 0 && nx < size && ny < size) {
          heightMap[ny][nx] += (12 - d) * 1.5;
        }
      }
    }
  }
  draw();
}

// –Ü–Ω—à—ñ –ø—Ä–æ—Ü–µ—Å–∏ (–±–µ–∑ –∑–º—ñ–Ω)
function rain() {
  const temp = heightMap.map(row => row.slice());
  for (let y = 0; y < size - 1; y++) {
    for (let x = 0; x < size; x++) {
      if (temp[y][x] > temp[y+1][x] + 0.5) {
        const diff = (temp[y][x] - temp[y+1][x]) * 0.3;
        heightMap[y][x] -= diff;
        heightMap[y+1][x] += diff * 0.7;
      }
    }
  }
  draw();
}

function wind() { /* –±–µ–∑ –∑–º—ñ–Ω */ for (let y = 0; y < size; y++) for (let x = 1; x < size; x++) { const t = heightMap[y][x] * 0.03; heightMap[y][x-1] += t; heightMap[y][x] -= t; } draw(); }
function glacier() { /* –∑–≥–ª–∞–¥–∂—É–≤–∞–Ω–Ω—è */ const temp = heightMap.map(r=>r.slice()); for (let y=1;y<size-1;y++) for (let x=1;x<size-1;x++) { let s=0; for (let dy=-1;dy<=1;dy++) for (let dx=-1;dx<=1;dx++) s += temp[y+dy][x+dx]; heightMap[y][x] = s/9; } draw(); }
function weathering() { for (let i=0;i<800;i++) { const x=rand(), y=rand(); if (heightMap[y][x]>5) heightMap[y][x]-=0.9; } draw(); }
function flood() { for (let y=0;y<size;y++) for (let x=0;x<size;x++) if (heightMap[y][x]<5) heightMap[y][x]-=3; draw(); }
function earthquake() { for (let i=0;i<600;i++) heightMap[rand()][rand()] += (Math.random()-0.5)*12; draw(); }
function landslide() { for (let y=size-2;y>=0;y--) for (let x=0;x<size;x++) if (heightMap[y][x] > heightMap[y+1][x]+6) { const d=(heightMap[y][x]-heightMap[y+1][x]-6)/2; heightMap[y][x]-=d; heightMap[y+1][x]+=d; } draw(); }
function eruption() { volcano(); earthquake(); draw(); }

function randomWorld() {
  uplift(); uplift(); volcano(); volcano(); rain(); rain(); rain(); glacier(); weathering(); fault();
  draw();
}

function resetWorld() { init(); }
function rand() { return Math.floor(Math.random() * size); }

init();
</script>

</body>
</html>
