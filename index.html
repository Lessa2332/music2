<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–¢–≤–æ—Ä–µ—Ü—å –°–≤—ñ—Ç—ñ–≤ ‚Äî –§–æ—Ä–º—É–≤–∞–Ω–Ω—è —Ä–µ–ª—å—î—Ñ—É</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #0e1b24;
  color: #fff;
  text-align: center;
  touch-action: manipulation;
}

h1 { margin: 12px; }

#container {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 20px;
  padding: 10px;
}

canvas {
  border: 3px solid #fff;
  border-radius: 8px;
  box-shadow: 0 0 20px rgba(0,0,0,0.8);
  touch-action: none;
}

.controls {
  min-width: 320px;
  max-width: 360px;
  padding: 15px;
  background: rgba(255,255,255,0.05);
  border-radius: 10px;
  text-align: left;
}

.controls h3 {
  margin: 15px 0 8px;
  color: #ffd966;
  font-size: 18px;
}

button {
  width: 100%;
  margin: 5px 0;
  padding: 10px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-size: 15px;
  transition: transform 0.1s;
}

button:active { transform: scale(0.98); }

.internal { background: #c0392b; color: #fff; }
.external { background: #2980b9; color: #fff; }
.disaster { background: #8e44ad; color: #fff; }
.utility  { background: #27ae60; color: #fff; }

#brush-size {
  display: flex;
  gap: 10px;
  margin: 10px 0;
}

#brush-size button {
  flex: 1;
  background: #34495e;
  padding: 8px;
  font-size: 14px;
}

#brush-size button.active {
  background: #ffd966;
  color: #000;
}

#info {
  font-size: 13px;
  margin-top: 12px;
  opacity: 0.9;
  line-height: 1.4;
}
</style>
</head>

<body>

<h1>üåç –¢–≤–æ—Ä–µ—Ü—å –°–≤—ñ—Ç—ñ–≤</h1>
<p>–Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–µ —Ñ–æ—Ä–º—É–≤–∞–Ω–Ω—è —Ä–µ–ª—å—î—Ñ—É (–ù–£–®)</p>

<div id="container">
  <canvas id="world" width="500" height="500"></canvas>

  <div class="controls">
    <h3>üñåÔ∏è –†–µ–∂–∏–º –º–∞–ª—é–≤–∞–Ω–Ω—è</h3>
    <div id="brush-size">
      <button class="active" onclick="setBrush(1)">–ú–∞–ª–∞</button>
      <button onclick="setBrush(3)">–°–µ—Ä–µ–¥–Ω—è</button>
      <button onclick="setBrush(5)">–í–µ–ª–∏–∫–∞</button>
    </div>
    <p style="font-size:13px;margin:8px 0;">‚úã –ú–∞–ª—é–π –º–∏—à–µ—é/–ø–∞–ª—å—Ü–µ–º<br>‚ÜïÔ∏è Shift ‚Äî –æ–ø—É—Å–∫–∞—Ç–∏ —Ä–µ–ª—å—î—Ñ</p>

    <h3>üî¥ –í–Ω—É—Ç—Ä—ñ—à–Ω—ñ –ø—Ä–æ—Ü–µ—Å–∏</h3>
    <button class="internal" onclick="uplift()">‚¨ÜÔ∏è –¢–µ–∫—Ç–æ–Ω—ñ—á–Ω–µ –ø—ñ–¥–Ω—è—Ç—Ç—è</button>
    <button class="internal" onclick="fault()">‚ö° –†–æ–∑–ª–æ–º</button>
    <button class="internal" onclick="volcano()">üåã –í—É–ª–∫–∞–Ω</button>

    <h3>üîµ –ó–æ–≤–Ω—ñ—à–Ω—ñ –ø—Ä–æ—Ü–µ—Å–∏</h3>
    <button class="external" onclick="rain()">üåß –†—ñ—á–∫–æ–≤–∞ –µ—Ä–æ–∑—ñ—è</button>
    <button class="external" onclick="wind()">üå¨ –í—ñ—Ç—Ä–æ–≤–∞ –µ—Ä–æ–∑—ñ—è</button>
    <button class="external" onclick="glacier()">üßä –ó–ª–µ–¥–µ–Ω—ñ–Ω–Ω—è</button>
    <button class="external" onclick="weathering()">ü™® –í–∏–≤—ñ—Ç—Ä—é–≤–∞–Ω–Ω—è</button>

    <h3>üö® –†–µ–∂–∏–º –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ</h3>
    <button class="disaster" onclick="flood()">üåä –ü–æ–≤—ñ–Ω—å</button>
    <button class="disaster" onclick="earthquake()">üåê –ó–µ–º–ª–µ—Ç—Ä—É—Å</button>
    <button class="disaster" onclick="landslide()">‚¨áÔ∏è –ó—Å—É–≤</button>
    <button class="disaster" onclick="eruption()">üî• –í–∏–≤–µ—Ä–∂–µ–Ω–Ω—è</button>

    <h3>‚öôÔ∏è –ö–µ—Ä—É–≤–∞–Ω–Ω—è</h3>
    <button class="utility" onclick="resetWorld()">üîÑ –û—á–∏—Å—Ç–∏—Ç–∏ —Å–≤—ñ—Ç</button>
    <button class="utility" onclick="randomWorld()">üé≤ –í–∏–ø–∞–¥–∫–æ–≤–∏–π —Å–≤—ñ—Ç</button>

    <div id="info">
      üèî –§–æ—Ä–º–∏ —Ä–µ–ª—å—î—Ñ—É –ø–æ–∑–Ω–∞—á–∞—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ<br>
      üí° –°–ø—Ä–æ–±—É–π —Å—Ç–≤–æ—Ä–∏—Ç–∏ –≥–æ—Ä–∏, –∞ –ø–æ—Ç—ñ–º –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –µ—Ä–æ–∑—ñ—é!
    </div>
  </div>
</div>

<script>
const canvas = document.getElementById("world");
const ctx = canvas.getContext("2d");

const size = 100; // –∑–±—ñ–ª—å—à–µ–Ω–æ –¥–ª—è –ø–ª–∞–≤–Ω–æ—Å—Ç—ñ
const cell = canvas.width / size;
let heightMap = [];
let brushSize = 1;
let lowering = false;

function init() {
  heightMap = Array.from({length: size}, () => Array(size).fill(0));
  draw();
}

function getColor(h) {
  if (h <= -5) return "#003366";     // –≥–ª–∏–±–æ–∫–∏–π –æ–∫–µ–∞–Ω
  if (h <= 0)  return "#006699";     // –æ–∫–µ–∞–Ω
  if (h <= 2)  return "#66b2ff";     // –º—ñ–ª–∏–Ω–∞
  if (h <= 8)  return "#b3ff99";     // –±–µ—Ä–µ–≥/—Ä—ñ–≤–Ω–∏–Ω–∞
  if (h <= 18) return "#99cc66";     // –Ω–∏–∑—å–∫—ñ –ø–∞–≥–æ—Ä–±–∏
  if (h <= 30) return "#b3863d";     // –ø–∞–≥–æ—Ä–±–∏
  if (h <= 45) return "#888888";     // –≥–æ—Ä–∏
  return "#ffffff";                  // —Å–Ω—ñ–≥–æ–≤—ñ –≤–µ—Ä—à–∏–Ω–∏
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // –ú–∞–ª—é—î–º–æ —Ä–µ–ª—å—î—Ñ
  for (let y = 0; y < size; y++) {
    for (let x = 0; x < size; x++) {
      const h = heightMap[y][x];
      ctx.fillStyle = getColor(h);
      ctx.fillRect(x * cell, y * cell, cell, cell);
    }
  }

  // –ù–∞–ø—ñ–≤–ø—Ä–æ–∑–æ—Ä–∞ –≤–æ–¥–∞ –Ω–∞–¥ –Ω–∏–∑—å–∫–∏–º–∏ –¥—ñ–ª—è–Ω–∫–∞–º–∏
  ctx.fillStyle = "rgba(0, 100, 200, 0.4)";
  for (let y = 0; y < size; y++) {
    for (let x = 0; x < size; x++) {
      if (heightMap[y][x] <= 0) {
        ctx.fillRect(x * cell, y * cell, cell, cell);
      }
    }
  }

  drawDynamicLabels();
}

function drawDynamicLabels() {
  ctx.fillStyle = "rgba(0,0,0,0.6)";
  ctx.fillRect(4, 4, 140, 92);
  ctx.strokeStyle = "#fff";
  ctx.lineWidth = 2;
  ctx.strokeRect(4, 4, 140, 92);

  ctx.fillStyle = "white";
  ctx.font = "bold 14px Arial";
  ctx.textAlign = "left";

  let hasMountains = false, hasPlains = false, hasLowlands = false;

  for (let y = 0; y < size; y++) {
    for (let x = 0; x < size; x++) {
      const h = heightMap[y][x];
      if (h > 30) hasMountains = true;
      if (h > 0 && h <= 15) hasPlains = true;
      if (h <= 0) hasLowlands = true;
    }
  }

  let offset = 20;
  if (hasMountains) { ctx.fillText("‚õ∞ –ì–æ—Ä–∏", 12, offset); offset += 22; }
  if (hasPlains)    { ctx.fillText("‚ñ≠ –†—ñ–≤–Ω–∏–Ω–∏", 12, offset); offset += 22; }
  if (hasLowlands)  { ctx.fillText("‚àá –ù–∏–∑–æ–≤–∏–Ω–∏ / –û–∫–µ–∞–Ω", 12, offset); }
}

// –ú–∞–ª—é–≤–∞–Ω–Ω—è
canvas.addEventListener("pointerdown", e => { sculpt(e); });
canvas.addEventListener("pointermove", e => { if (e.buttons === 1 || e.pointerType === "touch") sculpt(e); });

document.addEventListener("keydown", e => { if (e.key === "Shift") lowering = true; });
document.addEventListener("keyup", e => { if (e.key === "Shift") lowering = false; });

function sculpt(e) {
  const rect = canvas.getBoundingClientRect();
  const x = Math.floor((e.clientX - rect.left) / cell);
  const y = Math.floor((e.clientY - rect.top) / cell);
  if (x < 0 || y < 0 || x >= size || y >= size) return;

  const strength = lowering ? -1.5 : 1.5;
  const r = Math.floor(brushSize / 2);

  for (let dy = -r; dy <= r; dy++) {
    for (let dx = -r; dx <= r; dx++) {
      const nx = x + dx;
      const ny = y + dy;
      if (nx >= 0 && ny >= 0 && nx < size && ny < size) {
        const dist = Math.sqrt(dx*dx + dy*dy);
        if (dist <= r) {
          heightMap[ny][nx] += strength * (1 - dist / (r + 1));
        }
      }
    }
  }
  draw();
}

function setBrush(size) {
  brushSize = size;
  document.querySelectorAll("#brush-size button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
}

// –ü—Ä–æ—Ü–µ—Å–∏
function uplift() {
  for (let i = 0; i < 400; i++) heightMap[rand()][rand()] += 3;
  draw();
}

function fault() {
  const fx = rand();
  for (let y = 0; y < size; y++) {
    for (let x = Math.max(0, fx-5); x < Math.min(size, fx+5); x++) {
      heightMap[y][x] -= 6;
    }
  }
  draw();
}

function volcano() {
  const cx = Math.floor(size / 2), cy = Math.floor(size / 2);
  for (let dy = -10; dy <= 10; dy++) {
    for (let dx = -10; dx <= 10; dx++) {
      const d = Math.sqrt(dx*dx + dy*dy);
      if (d < 10) {
        const nx = cx + dx, ny = cy + dy;
        if (nx >= 0 && ny >= 0 && nx < size && ny < size) {
          heightMap[ny][nx] += (10 - d) * 1.2;
        }
      }
    }
  }
  draw();
}

function rain() {
  const temp = heightMap.map(row => row.slice());
  for (let y = 0; y < size - 1; y++) {
    for (let x = 0; x < size; x++) {
      if (temp[y][x] > temp[y+1][x] + 0.5) {
        const diff = (temp[y][x] - temp[y+1][x]) * 0.3;
        heightMap[y][x] -= diff;
        heightMap[y+1][x] += diff * 0.7;
      }
    }
  }
  draw();
}

function wind() {
  for (let y = 0; y < size; y++) {
    for (let x = 1; x < size; x++) {
      const transfer = heightMap[y][x] * 0.03;
      heightMap[y][x-1] += transfer;
      heightMap[y][x] -= transfer;
    }
  }
  draw();
}

function glacier() {
  const temp = heightMap.map(row => row.slice());
  for (let y = 1; y < size-1; y++) {
    for (let x = 1; x < size-1; x++) {
      let sum = 0;
      for (let dy = -1; dy <= 1; dy++) {
        for (let dx = -1; dx <= 1; dx++) {
          sum += temp[y+dy][x+dx];
        }
      }
      heightMap[y][x] = sum / 9;
    }
  }
  draw();
}

function weathering() {
  for (let i = 0; i < 600; i++) {
    const x = rand(), y = rand();
    if (heightMap[y][x] > 5) heightMap[y][x] -= 0.8;
  }
  draw();
}

function flood() {
  for (let y = 0; y < size; y++) {
    for (let x = 0; x < size; x++) {
      if (heightMap[y][x] < 5) heightMap[y][x] -= 2;
    }
  }
  draw();
}

function earthquake() {
  for (let i = 0; i < 500; i++) {
    const x = rand(), y = rand();
    heightMap[y][x] += (Math.random() - 0.5) * 10;
  }
  draw();
}

function landslide() {
  for (let y = size-2; y >= 0; y--) {
    for (let x = 0; x < size; x++) {
      if (heightMap[y][x] > heightMap[y+1][x] + 5) {
        const diff = (heightMap[y][x] - heightMap[y+1][x] - 5) / 2;
        heightMap[y][x] -= diff;
        heightMap[y+1][x] += diff;
      }
    }
  }
  draw();
}

function eruption() {
  volcano();
  earthquake();
  draw();
}

function randomWorld() {
  uplift(); uplift(); volcano(); rain(); rain(); rain(); glacier(); weathering();
  draw();
}

function resetWorld() { init(); }
function rand() { return Math.floor(Math.random() * size); }

init();
</script>

</body>
</html>
